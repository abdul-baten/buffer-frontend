<section class="b-main-content b-of-h">
  <div class="b-w-full b-h-toolbar p-px-4 b-br-b">
    <buffer--toolbar [backButton]="true" [showConnections]="false" headerTitle="Scheduled"></buffer--toolbar>
  </div>

  <section class="b-hs-wt-h b-of-h">
    <p-table #postTable [rowsPerPageOptions]="[10,25,50]" [rows]="10" [showCurrentPageReport]="true"
      [value]="calendarPosts | async" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} posts"
      dataKey="id" [alwaysShowPaginator]="false" [filterDelay]="0" [globalFilterFields]="['postCaption']"
      [paginator]="true">
      <ng-template pTemplate="caption">
        <div class="p-px-4 b-h-toolbar">
          <buffer--bucket-header (inputChange)="inputChanged($event)" (dropdownChange)="dropdownChanged($event)">
          </buffer--bucket-header>
        </div>
      </ng-template>
      <ng-template pTemplate="body" let-post>
        <tr>
          <td class="p-pr-3">
            <div class="b-w-full" *ngIf="post.postType === postType.IMAGE || post.postType === postType.VIDEO">
              <div [ngSwitch]="post.postType">
                <div *ngSwitchCase="postType.IMAGE">
                  <p-carousel [value]="post.postMedia" [numVisible]="1" [numScroll]="2" indicatorsContentClass="b-d-h"
                    styleClass="buffer--height-20">
                    <ng-template let-postMedia pTemplate="item">
                      <div class="b-w-full b-h-full p-d-flex p-jc-between p-ai-center">
                        <img [alt]="postMedia.mediaName" [src]="postMedia.mediaURL" class="b-w-full b-br-sm" />
                      </div>
                    </ng-template>
                  </p-carousel>
                </div>
                <div *ngSwitchCase="postType.VIDEO" class="p-px-4">
                  <video id="postVideo" preload controls [src]="post.postMedia[0].mediaURL" type="video/mp4"
                    class="b-w-full b-br-sm">
                  </video>
                </div>
              </div>
            </div>
          </td>
          <td colspan="3" class="p-pr-5">
            <div class="b-text-fade">
              <p class="b-c-black">{{ post.postCaption }}</p>
            </div>
          </td>
          <td class="p-mx-auto">
            <div class="p-d-flex p-flex-column">
              <small class="p-mb-2"><i class="pi pi-calendar b-va-m p-mr-1"></i>
                {{ post.postScheduleDateTime | date: 'EEE, MMM dd, y' }}</small>
              <small><i class="pi pi-clock b-va-m p-mr-1"></i> {{ post.postScheduleDateTime | date: 'h:mm a' }}</small>
            </div>
          </td>
          <td>
            <div class="p-d-flex p-jc-between p-ai-center">
              <span
                [ngClass]="{ 'p-tag-warning': post.postType === postType.TEXT, 'p-tag-success': post.postType === postType.IMAGE, 'p-tag-info': post.postType === postType.VIDEO}"
                class="p-text-capitalize p-tag">{{ post.postType }}</span>
              <div class="b-ca b-ca-md p-mx-auto"
                [title]="splitConnectionType(post.postConnection.connectionType ? post.postConnection.connectionType: '')">
                <img [lazyLoad]="post.postConnection.connectionPicture" class="b-w-full b-h-full b-br-full"
                  defaultImage="/assets/images/svg/default-media.svg"
                  errorImage="/assets/images/svg/default-media.svg" />
                <div [attr.class]="'b-ca-sl b-ca-sl-' + post.postConnection.connectionType">
                </div>
              </div>
            </div>
          </td>
          <td class="p-pr-3">
            <p-splitButton label="Publish" styleClass="p-splitbutton-sm b-w-full" [model]="getMenuItems(post)"
              appendTo="body" menuStyleClass="p-p-2">
            </p-splitButton>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="4">
            <div class="p-m-5">
              <div class="b-h-full p-d-flex p-flex-column p-ai-center">
                <div class="p-my-5 p-text-center">
                  <h3>No post found</h3>
                </div>
              </div>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </section>
</section>