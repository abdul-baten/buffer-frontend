<p-table #postTable [rowsPerPageOptions]="[10,25,50,100]" [rows]="10" [showCurrentPageReport]="true"
  [value]="$any(single_posts)" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} posts"
  dataKey="id" [alwaysShowPaginator]="false" [filterDelay]="0" [globalFilterFields]="['post_status']" [paginator]="true"
  styleClass="p-datatable-striped">
  <ng-template pTemplate="caption">
    <div class="b-h-full p-grid p-justify-between p-align-center p-px-5 p-m-0">
      <div class="p-col-4 p-p-0">
        <h5>Post insights</h5>
      </div>
      <div class="p-col-4 p-p-0">
        <span class="p-input-icon-left b-w-full">
          <i class="ico ico-search"></i>
          <input type="text" pInputText placeholder="Filter by message" autocomplete="off"
            (input)="postTable.filterGlobal($any($event.target).value, 'contains')" class="p-inputtext-sm b-w-full">
        </span>
      </div>
    </div>
  </ng-template>
  <ng-template pTemplate="header">
    <tr>
      <th></th>
      <th>Attachment</th>
      <th colspan="3">Message</th>
      <th colspan="2">Created</th>
      <th>Likes</th>
      <th>Comments</th>
      <th>Shares</th>
      <th>Reactions</th>
      <th></th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-post let-expanded="expanded">
    <tr>
      <td>
        <button type="button" pButton [pRowToggler]="post" class="p-button-text p-button-rounded p-button-plain"
          [icon]="expanded ? 'ico-md ico-curved-down' : 'ico-md ico-curved-right'"></button>
      </td>
      <td>
        <ng-container *ngIf="post?.post_thumbnail">
          <img [src]="post?.post_thumbnail" class="b-w-full b-br-sm p-p-1" />
        </ng-container>
      </td>
      <td colspan="3">
        <div class="b-text-fade">
          <p class="b-c-black">{{ post.post_status }}</p>
        </div>
        <div class="p-mt-3" *ngIf="post.post_hash_tags">
          <div class="badges">
            <span *ngFor="let hash_tag of post.post_hash_tags; trackBy:trackBy;"
              class="p-tag p-tag-secondary">{{ hash_tag }}</span>
          </div>
        </div>
      </td>
      <td colspan="2">
        <small class="p-mb-2"><i class="ico-md ico-clock-time b-va-m p-mr-1"></i>
          {{ post.post_created_time | date: 'medium' }}</small>
      </td>
      <td>
        <h6 class="p-text-bold">{{ post.post_likes_count || 0 }}</h6>
      </td>
      <td>
        <h6 class="p-text-bold">{{ post.post_comments_count || 0 }}</h6>
      </td>
      <td>
        <h6 class="p-text-bold">{{ post.post_shares_count || 0 }}</h6>
      </td>
      <td>
        <h6 class="p-text-bold">{{ post.post_reactions_count || 0 }}</h6>
      </td>
      <td>
        <button pTooltip="View post" tooltipPosition="top" pButton icon="ico ico-external-link"
          class="p-button-sm p-button-rounded p-button-text p-button-plain"
          (click)="viewPost(post.post_permalink)"></button>
      </td>
    </tr>
  </ng-template>
  <ng-template pTemplate="rowexpansion" let-post>
    <tr>
      <td colspan="12">
        <p-table [value]="[post.post_insights]" dataKey="id">
          <ng-template pTemplate="header">
    <tr>
      <th>Engagement</th>
      <th>Engaged Fans</th>
      <th>Impressions</th>
      <th>Reach</th>
      <th>Post Clicks</th>
      <th>Negativity</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-insight>
    <tr>
      <td>
        <h6 class="p-text-bold">{{ insight.post_engaged_users }}</h6>
      </td>
      <td>
        <h6 class="p-text-bold">{{ insight.post_engaged_fan }}</h6>
      </td>
      <td>
        <h6 class="p-text-bold">{{ insight.post_impressions }}</h6>
      </td>
      <td>
        <h6 class="p-text-bold">{{ insight.post_impressions_unique }}</h6>
      </td>
      <td>
        <h6 class="p-text-bold">{{ insight.post_clicks }}</h6>
      </td>
      <td>
        <h6 class="p-text-bold">{{ insight.post_negative_feedback }}</h6>
      </td>
    </tr>
  </ng-template>
</p-table>
</td>
</tr>
</ng-template>
<ng-template pTemplate="emptymessage">
  <tr>
    <td colspan="12">
      <div class="p-my-6">
        <buffer-no-data-found class="b-h-full">
          <h5>No post found</h5>
        </buffer-no-data-found>
      </div>
    </td>
  </tr>
</ng-template>
</p-table>